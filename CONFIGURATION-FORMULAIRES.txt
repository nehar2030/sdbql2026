â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“§ GUIDE COMPLET - CONFIGURATION GOOGLE APPS SCRIPT
  Formulaires Newsletter + Contact â†’ Google Sheets
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ OBJECTIF
-----------
Connecter les formulaires de votre site web Ã  Google Sheets via Google Apps Script
pour collecter automatiquement les inscriptions Newsletter et les messages Contact.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  PARTIE 1 : CRÃ‰ER LE GOOGLE SHEET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Allez sur https://sheets.google.com

2. CrÃ©ez un nouveau tableur :
   - Cliquez sur "+" (Nouveau)
   - Nommez-le : "SDBQL 2026 - Formulaires"

3. Copiez l'ID du Sheet depuis l'URL :
   URL : https://docs.google.com/spreadsheets/d/XXXXXXXXXXXXXXXXXXXXX/edit
                                                 â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘
                                                 C'EST VOTRE ID !

4. GARDEZ cet ID - vous en aurez besoin !

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  PARTIE 2 : CRÃ‰ER LE SCRIPT NEWSLETTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 1 : CrÃ©er le Script
--------------------------
1. Allez sur https://script.google.com
2. Cliquez sur "Nouveau projet"
3. Nommez le projet : "SDBQL Newsletter"

Ã‰TAPE 2 : Coller le Code
-------------------------
Supprimez tout le code existant et collez ceci :

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ function doPost(e) {                                            â”‚
â”‚   try {                                                         â”‚
â”‚     // RÃ©cupÃ©rer l'email                                       â”‚
â”‚     var email = e.parameter.email;                             â”‚
â”‚                                                                 â”‚
â”‚     // ID de votre Google Sheet                               â”‚
â”‚     var sheetId = 'VOTRE_ID_GOOGLE_SHEET_ICI';                â”‚
â”‚     var sheet = SpreadsheetApp.openById(sheetId)              â”‚
â”‚                                .getSheetByName('Newsletter');  â”‚
â”‚                                                                 â”‚
â”‚     // Si la feuille n'existe pas, la crÃ©er                   â”‚
â”‚     if (!sheet) {                                              â”‚
â”‚       sheet = SpreadsheetApp.openById(sheetId)                â”‚
â”‚                             .insertSheet('Newsletter');        â”‚
â”‚       sheet.appendRow(['Date', 'Email']); // En-tÃªtes         â”‚
â”‚     }                                                           â”‚
â”‚                                                                 â”‚
â”‚     // Ajouter les donnÃ©es                                     â”‚
â”‚     var date = new Date();                                     â”‚
â”‚     sheet.appendRow([date, email]);                            â”‚
â”‚                                                                 â”‚
â”‚     // Retourner succÃ¨s                                        â”‚
â”‚     return ContentService.createTextOutput(JSON.stringify({   â”‚
â”‚       'status': 'success',                                     â”‚
â”‚       'message': 'Inscription rÃ©ussie !'                       â”‚
â”‚     })).setMimeType(ContentService.MimeType.JSON);            â”‚
â”‚                                                                 â”‚
â”‚   } catch (error) {                                            â”‚
â”‚     return ContentService.createTextOutput(JSON.stringify({   â”‚
â”‚       'status': 'error',                                       â”‚
â”‚       'message': 'Erreur: ' + error.toString()                â”‚
â”‚     })).setMimeType(ContentService.MimeType.JSON);            â”‚
â”‚   }                                                             â”‚
â”‚ }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ã‰TAPE 3 : Remplacer l'ID du Sheet
----------------------------------
Ã€ la ligne :
   var sheetId = 'VOTRE_ID_GOOGLE_SHEET_ICI';

Remplacez 'VOTRE_ID_GOOGLE_SHEET_ICI' par l'ID que vous avez copiÃ© Ã  la Partie 1.

Exemple :
   var sheetId = '1a2b3c4d5e6f7g8h9i0jklmnopqrstuvwxyz';

Ã‰TAPE 4 : DÃ©ployer le Script
-----------------------------
1. Cliquez sur "DÃ©ployer" (en haut Ã  droite) â†’ "Nouveau dÃ©ploiement"
2. Cliquez sur l'icÃ´ne âš™ï¸ (roue dentÃ©e) â†’ SÃ©lectionnez "Application Web"
3. Configuration :
   - Description : "SDBQL Newsletter API"
   - ExÃ©cuter en tant que : "Moi"
   - Qui a accÃ¨s : "Tout le monde"
4. Cliquez sur "DÃ©ployer"
5. Autorisez l'accÃ¨s (cliquez sur "Autoriser l'accÃ¨s")
6. SÃ©lectionnez votre compte Google
7. Cliquez sur "AvancÃ©" puis "AccÃ©der Ã  SDBQL Newsletter (unsafe)"
8. Cliquez sur "Autoriser"

Ã‰TAPE 5 : Copier l'URL de DÃ©ploiement
--------------------------------------
Une URL apparaÃ®t :
   https://script.google.com/macros/s/XXXXXXXXXXXXXXXXXXXXXXX/exec
                                        â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘
                                        COPIEZ CETTE URL COMPLÃˆTE !

GARDEZ cette URL - vous en aurez besoin pour le site web !

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  PARTIE 3 : CRÃ‰ER LE SCRIPT CONTACT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 1 : CrÃ©er un Nouveau Script
----------------------------------
1. Retournez sur https://script.google.com
2. Cliquez sur "Nouveau projet"
3. Nommez le projet : "SDBQL Contact"

Ã‰TAPE 2 : Coller le Code
-------------------------
Supprimez tout le code existant et collez ceci :

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ function doPost(e) {                                            â”‚
â”‚   try {                                                         â”‚
â”‚     // RÃ©cupÃ©rer les donnÃ©es                                   â”‚
â”‚     var name = e.parameter.name;                               â”‚
â”‚     var email = e.parameter.email;                             â”‚
â”‚     var subject = e.parameter.subject;                         â”‚
â”‚     var message = e.parameter.message;                         â”‚
â”‚                                                                 â”‚
â”‚     // ID de votre Google Sheet                               â”‚
â”‚     var sheetId = 'VOTRE_ID_GOOGLE_SHEET_ICI';                â”‚
â”‚     var sheet = SpreadsheetApp.openById(sheetId)              â”‚
â”‚                                .getSheetByName('Contact');     â”‚
â”‚                                                                 â”‚
â”‚     // Si la feuille n'existe pas, la crÃ©er                   â”‚
â”‚     if (!sheet) {                                              â”‚
â”‚       sheet = SpreadsheetApp.openById(sheetId)                â”‚
â”‚                             .insertSheet('Contact');           â”‚
â”‚       sheet.appendRow(['Date', 'Nom', 'Email',                â”‚
â”‚                        'Sujet', 'Message']); // En-tÃªtes       â”‚
â”‚     }                                                           â”‚
â”‚                                                                 â”‚
â”‚     // Ajouter les donnÃ©es                                     â”‚
â”‚     var date = new Date();                                     â”‚
â”‚     sheet.appendRow([date, name, email, subject, message]);   â”‚
â”‚                                                                 â”‚
â”‚     // Retourner succÃ¨s                                        â”‚
â”‚     return ContentService.createTextOutput(JSON.stringify({   â”‚
â”‚       'status': 'success',                                     â”‚
â”‚       'message': 'Message envoyÃ© avec succÃ¨s !'               â”‚
â”‚     })).setMimeType(ContentService.MimeType.JSON);            â”‚
â”‚                                                                 â”‚
â”‚   } catch (error) {                                            â”‚
â”‚     return ContentService.createTextOutput(JSON.stringify({   â”‚
â”‚       'status': 'error',                                       â”‚
â”‚       'message': 'Erreur: ' + error.toString()                â”‚
â”‚     })).setMimeType(ContentService.MimeType.JSON);            â”‚
â”‚   }                                                             â”‚
â”‚ }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ã‰TAPE 3 : Remplacer l'ID du Sheet
----------------------------------
Remplacez 'VOTRE_ID_GOOGLE_SHEET_ICI' par le MÃŠME ID que prÃ©cÃ©demment
(c'est le mÃªme Google Sheet, mais deux feuilles diffÃ©rentes).

Ã‰TAPE 4 : DÃ©ployer le Script
-----------------------------
RÃ©pÃ©tez les mÃªmes Ã©tapes que pour Newsletter (Partie 2, Ã‰tape 4)

Ã‰TAPE 5 : Copier l'URL de DÃ©ploiement
--------------------------------------
Copiez l'URL du dÃ©ploiement Contact.
Vous avez maintenant 2 URLs :
   - URL Newsletter
   - URL Contact

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  PARTIE 4 : CONFIGURER LE SITE WEB
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 1 : Ouvrir le Fichier forms-handler.js
---------------------------------------------
Ouvrez le fichier : forms-handler.js

Ã‰TAPE 2 : Remplacer les URLs
-----------------------------
Trouvez ces lignes (environ lignes 11-14) :

const NEWSLETTER_SCRIPT_URL = 'https://script.google.com/macros/s/VOTRE_ID_NEWSLETTER/exec';
const CONTACT_SCRIPT_URL = 'https://script.google.com/macros/s/VOTRE_ID_CONTACT/exec';

Remplacez-les par vos URLs de dÃ©ploiement :

const NEWSLETTER_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbXXXXXXXXXXXX/exec';
                                                                      â†‘ URL Newsletter
const CONTACT_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbYYYYYYYYYYYY/exec';
                                                                   â†‘ URL Contact

Ã‰TAPE 3 : Sauvegarder
----------------------
Sauvegardez le fichier forms-handler.js

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  PARTIE 5 : TESTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TEST 1 : Tester le Site en Local
---------------------------------
1. Ouvrez index.html dans votre navigateur
2. Testez le formulaire Newsletter :
   - Entrez un email
   - Cliquez sur â†’
   - Vous devriez voir : "âœ… Inscription rÃ©ussie !"
3. Testez le formulaire Contact :
   - Remplissez tous les champs
   - Cliquez sur "Envoyer le message"
   - Vous devriez voir : "Message envoyÃ© avec succÃ¨s !"

TEST 2 : VÃ©rifier Google Sheets
--------------------------------
1. Ouvrez votre Google Sheet
2. Vous devriez voir 2 nouvelles feuilles :
   - "Newsletter" avec votre email
   - "Contact" avec votre message

Si vous voyez les donnÃ©es â†’ âœ… C'EST BON !

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  PARTIE 6 : HÃ‰BERGER LE SITE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Une fois que tout fonctionne en local :

1. Uploadez TOUS les fichiers sur votre hÃ©bergeur :
   - index.html
   - forms-handler.js â† NOUVEAU FICHIER !
   - Tous les autres fichiers CSS/JS
   
2. Testez sur le site en ligne

3. Les donnÃ©es seront collectÃ©es automatiquement dans Google Sheets !

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ› DÃ‰PANNAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PROBLÃˆME : "Erreur de connexion"
SOLUTION : VÃ©rifiez que les URLs dans forms-handler.js sont correctes

PROBLÃˆME : "Erreur: Exception: Cannot find sheet"
SOLUTION : VÃ©rifiez que l'ID du Sheet dans le Google Apps Script est correct

PROBLÃˆME : Rien ne se passe
SOLUTION : 
   1. Ouvrez la console du navigateur (F12)
   2. VÃ©rifiez s'il y a des erreurs JavaScript
   3. VÃ©rifiez que forms-handler.js est bien chargÃ©

PROBLÃˆME : "Access denied"
SOLUTION : 
   1. Retournez dans Google Apps Script
   2. DÃ©ploiement â†’ GÃ©rer les dÃ©ploiements
   3. VÃ©rifiez que "Qui a accÃ¨s" = "Tout le monde"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“Š CONSULTER LES DONNÃ‰ES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Pour voir les inscriptions :
1. Ouvrez votre Google Sheet
2. Feuille "Newsletter" : Liste des emails
3. Feuille "Contact" : Liste des messages

Les donnÃ©es sont ajoutÃ©es en temps rÃ©el !

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”’ SÃ‰CURITÃ‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Les donnÃ©es sont stockÃ©es dans VOTRE Google Sheet (privÃ©)
âœ… Seuls les propriÃ©taires du Sheet peuvent voir les donnÃ©es
âœ… Les URLs Google Apps Script sont publiques mais sÃ©curisÃ©es
âœ… Aucune donnÃ©e sensible n'est exposÃ©e dans le code du site

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âœ… CHECKLIST FINALE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ ] Google Sheet crÃ©Ã© avec l'ID copiÃ©
[ ] Script Newsletter crÃ©Ã© et dÃ©ployÃ©
[ ] Script Contact crÃ©Ã© et dÃ©ployÃ©
[ ] Les 2 URLs de dÃ©ploiement copiÃ©es
[ ] forms-handler.js modifiÃ© avec les bonnes URLs
[ ] TestÃ© en local - Newsletter fonctionne
[ ] TestÃ© en local - Contact fonctionne
[ ] DonnÃ©es visibles dans Google Sheets
[ ] Site hÃ©bergÃ© avec forms-handler.js inclus

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‰ FÃ©licitations ! Vos formulaires sont maintenant connectÃ©s Ã  Google Sheets !

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Questions ? VÃ©rifiez la console du navigateur (F12) pour les erreurs.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
