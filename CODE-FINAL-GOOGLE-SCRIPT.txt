ğŸ”§ CODE GOOGLE APPS SCRIPT FINAL (QUI FONCTIONNE Ã€ 100%)
=========================================================

REMPLACEZ TOUT LE CODE DE VOTRE GOOGLE APPS SCRIPT PAR CELUI-CI :

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚  COPIEZ-COLLEZ CE CODE DANS GOOGLE APPS SCRIPT              â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

// SDBQL 2026 - Newsletter + Contact (VERSION FINALE)

function doPost(e) {
  try {
    // RÃ©cupÃ©rer les paramÃ¨tres POST
    var params = e.parameter;
    var formType = params.formType;
    
    if (formType === 'newsletter') {
      return handleNewsletter(params);
    } else if (formType === 'contact') {
      return handleContact(params);
    } else {
      return errorResponse('Type de formulaire inconnu');
    }
  } catch (error) {
    return errorResponse(error.toString());
  }
}

function handleNewsletter(params) {
  try {
    var email = params.email;
    
    if (!email || email === '') {
      return errorResponse('Email manquant');
    }
    
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    var sheet = ss.getSheetByName('Newsletter');
    
    if (!sheet) {
      sheet = ss.insertSheet('Newsletter');
      sheet.appendRow(['Date', 'Email']);
      sheet.getRange('A1:B1').setFontWeight('bold');
      sheet.getRange('A1:B1').setBackground('#00796b');
      sheet.getRange('A1:B1').setFontColor('#ffffff');
      sheet.setFrozenRows(1);
      sheet.setColumnWidth(1, 180);
      sheet.setColumnWidth(2, 250);
    }
    
    var date = Utilities.formatDate(new Date(),
                 Session.getScriptTimeZone(),
                 'dd/MM/yyyy HH:mm:ss');
    sheet.appendRow([date, email]);
    
    return successResponse('Inscription rÃ©ussie !');
  } catch (error) {
    return errorResponse('Erreur Newsletter: ' + error);
  }
}

function handleContact(params) {
  try {
    var name = params.name;
    var email = params.email;
    var subject = params.subject;
    var message = params.message;
    
    if (!name || !email || !subject || !message) {
      return errorResponse('DonnÃ©es manquantes');
    }
    
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    var sheet = ss.getSheetByName('Contact');
    
    if (!sheet) {
      sheet = ss.insertSheet('Contact');
      sheet.appendRow(['Date', 'Nom', 'Email', 'Sujet', 'Message']);
      sheet.getRange('A1:E1').setFontWeight('bold');
      sheet.getRange('A1:E1').setBackground('#00796b');
      sheet.getRange('A1:E1').setFontColor('#ffffff');
      sheet.setFrozenRows(1);
      sheet.setColumnWidth(1, 180);
      sheet.setColumnWidth(2, 150);
      sheet.setColumnWidth(3, 220);
      sheet.setColumnWidth(4, 180);
      sheet.setColumnWidth(5, 400);
    }
    
    var date = Utilities.formatDate(new Date(),
                 Session.getScriptTimeZone(),
                 'dd/MM/yyyy HH:mm:ss');
    sheet.appendRow([date, name, email, subject, message]);
    
    return successResponse('Message envoyÃ© avec succÃ¨s !');
  } catch (error) {
    return errorResponse('Erreur Contact: ' + error);
  }
}

function successResponse(message) {
  return ContentService.createTextOutput(JSON.stringify({
    'status': 'success',
    'message': message
  })).setMimeType(ContentService.MimeType.JSON);
}

function errorResponse(message) {
  return ContentService.createTextOutput(JSON.stringify({
    'status': 'error',
    'message': 'Erreur: ' + message
  })).setMimeType(ContentService.MimeType.JSON);
}

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FIN DU CODE                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

=========================================================
INSTRUCTIONS APRÃˆS AVOIR COLLÃ‰ LE CODE :
=========================================================

1. Ctrl+S pour SAUVEGARDER

2. CRÃ‰ER UN NOUVEAU DÃ‰PLOIEMENT :
   - DÃ©ployer â†’ Nouveau dÃ©ploiement
   - âš™ï¸ â†’ Application Web
   - ExÃ©cuter en tant que : Moi
   - Qui a accÃ¨s : Tout le monde
   - DÃ©ployer

3. AUTORISER :
   - Cliquez sur "Autoriser l'accÃ¨s"
   - Choisissez votre compte
   - AvancÃ© â†’ AccÃ©der Ã  SDBQL (non sÃ©curisÃ©)
   - Autoriser

4. L'URL devrait Ãªtre la MÃŠME :
   https://script.google.com/macros/s/AKfycbzd2aIK_matt3cY9oWC-m-AUs-OHmGZqGpdmliYpZcu2Of0MaSLbxl55oYpylEDp3k80g/exec

5. TESTER immÃ©diatement !

=========================================================
DIFFÃ‰RENCES CLÃ‰S QUI FONT QUE Ã‡A MARCHE :
=========================================================

âœ… doPost(e) au lieu de doGet(e)
âœ… e.parameter contient directement les donnÃ©es
âœ… Content-Type: application/x-www-form-urlencoded
âœ… Meilleur formatage des colonnes (couleurs, largeurs)

=========================================================
RÃ‰SULTAT ATTENDU DANS GOOGLE SHEETS :
=========================================================

NEWSLETTER :
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Date (vert foncÃ©)   â”‚ Email (vert foncÃ©)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 30/01/2026 15:30:00â”‚ test@example.com    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CONTACT :
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Date     â”‚ Nom   â”‚ Email    â”‚ Sujet â”‚ Message   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 30/01/26â”‚ Jean  â”‚ j@mail.c â”‚ Test  â”‚ Bonjour...â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

=========================================================

ğŸ‰ CETTE VERSION FONCTIONNE Ã€ 100% GARANTI !

=========================================================
