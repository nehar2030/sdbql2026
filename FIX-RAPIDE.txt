ğŸ”§ CORRECTION RAPIDE - Seule la date apparaÃ®t
==============================================

âŒ PROBLÃˆME : Seule la date s'enregistre, pas les autres donnÃ©es

âœ… SOLUTION : Remplacer le code Google Apps Script

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸš€ EN 3 Ã‰TAPES (2 MINUTES)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Ã‰TAPE 1 : Ouvrir votre Google Apps Script
------------------------------------------
Retournez dans l'onglet Google Apps Script
(Celui oÃ¹ vous avez dÃ©ployÃ© le script)


Ã‰TAPE 2 : Remplacer le Code
----------------------------
1. Supprimez TOUT le code actuel
2. Copiez-collez le code ci-dessous
3. Ctrl+S pour sauvegarder

PAS BESOIN DE REDÃ‰PLOYER ! Le dÃ©ploiement actuel fonctionne.


Ã‰TAPE 3 : Tester
----------------
1. Testez le formulaire Newsletter
2. VÃ©rifiez Google Sheets â†’ L'email apparaÃ®t maintenant ! âœ…


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ CODE Ã€ COPIER-COLLER
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

// SDBQL 2026 - Newsletter + Contact (CORRIGÃ‰)

function doGet(e) {
  try {
    var formType = e.parameter.formType;
    
    if (formType === 'newsletter') {
      return handleNewsletter(e);
    } else if (formType === 'contact') {
      return handleContact(e);
    } else {
      return errorResponse('Type de formulaire inconnu');
    }
  } catch (error) {
    return errorResponse(error.toString());
  }
}

function handleNewsletter(e) {
  try {
    var email = e.parameter.email;
    
    if (!email || email === '') {
      return errorResponse('Email manquant');
    }
    
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    var sheet = ss.getSheetByName('Newsletter');
    
    if (!sheet) {
      sheet = ss.insertSheet('Newsletter');
      sheet.appendRow(['Date', 'Email']);
      sheet.getRange('A1:B1').setFontWeight('bold');
      sheet.setFrozenRows(1);
    }
    
    var date = Utilities.formatDate(new Date(),
                 Session.getScriptTimeZone(),
                 'dd/MM/yyyy HH:mm:ss');
    sheet.appendRow([date, email]);
    
    return successResponse('Inscription rÃ©ussie !');
  } catch (error) {
    return errorResponse('Erreur Newsletter: ' + error);
  }
}

function handleContact(e) {
  try {
    var name = e.parameter.name;
    var email = e.parameter.email;
    var subject = e.parameter.subject;
    var message = e.parameter.message;
    
    if (!name || !email || !subject || !message) {
      return errorResponse('DonnÃ©es manquantes');
    }
    
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    var sheet = ss.getSheetByName('Contact');
    
    if (!sheet) {
      sheet = ss.insertSheet('Contact');
      sheet.appendRow(['Date', 'Nom', 'Email', 'Sujet', 'Message']);
      sheet.getRange('A1:E1').setFontWeight('bold');
      sheet.setFrozenRows(1);
      sheet.setColumnWidth(1, 150);
      sheet.setColumnWidth(2, 150);
      sheet.setColumnWidth(3, 200);
      sheet.setColumnWidth(4, 150);
      sheet.setColumnWidth(5, 400);
    }
    
    var date = Utilities.formatDate(new Date(),
                 Session.getScriptTimeZone(),
                 'dd/MM/yyyy HH:mm:ss');
    sheet.appendRow([date, name, email, subject, message]);
    
    return successResponse('Message envoyÃ© avec succÃ¨s !');
  } catch (error) {
    return errorResponse('Erreur Contact: ' + error);
  }
}

function successResponse(message) {
  return ContentService.createTextOutput(JSON.stringify({
    'status': 'success',
    'message': message
  })).setMimeType(ContentService.MimeType.JSON);
}

function errorResponse(message) {
  return ContentService.createTextOutput(JSON.stringify({
    'status': 'error',
    'message': 'Erreur: ' + message
  })).setMimeType(ContentService.MimeType.JSON);
}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… CE QUI CHANGE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

AVANT : doPost(e)  â†’ Ne marchait pas
MAINTENANT : doGet(e)  â†’ Fonctionne parfaitement !

Pourquoi ? FormData + POST ne fonctionne pas bien avec Google Apps Script.
Maintenant on utilise GET + URLSearchParams â†’ Tout fonctionne !

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š RÃ‰SULTAT ATTENDU
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Dans Google Sheets, vous verrez maintenant :

NEWSLETTER :
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Date                 â”‚ Email               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 30/01/2026 14:30:15 â”‚ test@example.com    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CONTACT :
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Date        â”‚ Nom    â”‚ Email    â”‚ Sujet â”‚ Message  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 30/01/26... â”‚ Jean   â”‚ jean@... â”‚ Test  â”‚ Bonjour  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ‰ C'EST TOUT !
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

AprÃ¨s avoir remplacÃ© le code et sauvegardÃ© :
âœ… Newsletter enregistrera : Date + Email
âœ… Contact enregistrera : Date + Nom + Email + Sujet + Message

Le fichier forms-handler.js a dÃ©jÃ  Ã©tÃ© corrigÃ© automatiquement !

==============================================
