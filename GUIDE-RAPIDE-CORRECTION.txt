ğŸ”§ GUIDE RAPIDE - Corriger l'Erreur "openById"
=================================================

âŒ ERREUR ACTUELLE
------------------
"Unexpected error while getting the method or property openById 
on object SpreadsheetApp"

âœ… SOLUTION EN 6 Ã‰TAPES
-----------------------

Ã‰TAPE 1 : Ouvrir votre Google Sheet
------------------------------------
Ouvrez : https://docs.google.com/spreadsheets/d/1h4zGCPpImYcc2x5wWi6m0QJpZFJnCtEC9jEfy_mIH30/edit


Ã‰TAPE 2 : CrÃ©er le Script DEPUIS le Sheet
------------------------------------------
Dans le Sheet : Extensions â†’ Apps Script


Ã‰TAPE 3 : Coller le Nouveau Code
---------------------------------
Supprimez tout et collez ce code :

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// SDBQL 2026 - Newsletter + Contact

function doPost(e) {
  try {
    var formType = e.parameter.formType;
    
    if (formType === 'newsletter') {
      return handleNewsletter(e);
    } else if (formType === 'contact') {
      return handleContact(e);
    } else {
      return errorResponse('Type de formulaire inconnu');
    }
  } catch (error) {
    return errorResponse(error.toString());
  }
}

function handleNewsletter(e) {
  var email = e.parameter.email;
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheetByName('Newsletter');
  
  if (!sheet) {
    sheet = ss.insertSheet('Newsletter');
    sheet.appendRow(['Date', 'Email']);
    sheet.getRange('A1:B1').setFontWeight('bold');
  }
  
  var date = new Date();
  sheet.appendRow([date, email]);
  
  return successResponse('Inscription rÃ©ussie !');
}

function handleContact(e) {
  var name = e.parameter.name;
  var email = e.parameter.email;
  var subject = e.parameter.subject;
  var message = e.parameter.message;
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheetByName('Contact');
  
  if (!sheet) {
    sheet = ss.insertSheet('Contact');
    sheet.appendRow(['Date', 'Nom', 'Email', 'Sujet', 'Message']);
    sheet.getRange('A1:E1').setFontWeight('bold');
  }
  
  var date = new Date();
  sheet.appendRow([date, name, email, subject, message]);
  
  return successResponse('Message envoyÃ© avec succÃ¨s !');
}

function successResponse(message) {
  return ContentService.createTextOutput(JSON.stringify({
    'status': 'success',
    'message': message
  })).setMimeType(ContentService.MimeType.JSON);
}

function errorResponse(message) {
  return ContentService.createTextOutput(JSON.stringify({
    'status': 'error',
    'message': 'Erreur: ' + message
  })).setMimeType(ContentService.MimeType.JSON);
}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


Ã‰TAPE 4 : Enregistrer
----------------------
Ctrl+S ou icÃ´ne disquette ğŸ’¾
Nommer : "SDBQL Formulaires"


Ã‰TAPE 5 : DÃ©ployer
-------------------
1. DÃ©ployer â†’ Nouveau dÃ©ploiement
2. âš™ï¸ â†’ Application Web
3. ExÃ©cuter en tant que : "Moi"
4. Qui a accÃ¨s : "Tout le monde"
5. DÃ©ployer
6. Autoriser l'accÃ¨s
7. AvancÃ© â†’ AccÃ©der Ã  SDBQL Formulaires
8. Autoriser


Ã‰TAPE 6 : Copier l'URL et Modifier forms-handler.js
----------------------------------------------------
1. Copiez l'URL : https://script.google.com/macros/s/XXXXX/exec

2. Ouvrez forms-handler.js (dans votre dossier site web)

3. Ligne 11, remplacez :
   const SCRIPT_URL = 'https://script.google.com/macros/s/VOTRE_URL_DEPLOIEMENT_ICI/exec';

   Par votre URL :
   const SCRIPT_URL = 'https://script.google.com/macros/s/XXXXX/exec';

4. Sauvegardez forms-handler.js


âœ… TESTER
---------
1. Ouvrez index.html
2. Testez Newsletter â†’ "âœ… Inscription rÃ©ussie !"
3. Testez Contact â†’ "Message envoyÃ© avec succÃ¨s !"
4. VÃ©rifiez Google Sheets â†’ 2 feuilles crÃ©Ã©es


ğŸ‰ C'EST TOUT !
---------------
Le forms-handler.js a dÃ©jÃ  Ã©tÃ© mis Ã  jour avec formType.
Vous n'avez qu'Ã  copier-coller le nouveau script Google Apps
et remplacer l'URL !


ğŸ“ NOTE IMPORTANTE
------------------
Le fichier forms-handler.js a Ã©tÃ© CORRIGÃ‰ automatiquement avec :
âœ… Une seule URL (au lieu de 2)
âœ… Le paramÃ¨tre formType ajoutÃ© automatiquement
âœ… PrÃªt Ã  l'emploi

Vous n'avez QU'Ã€ :
1. CrÃ©er le script Google Apps (code ci-dessus)
2. Copier l'URL de dÃ©ploiement
3. Remplacer l'URL ligne 11 dans forms-handler.js

=================================================
