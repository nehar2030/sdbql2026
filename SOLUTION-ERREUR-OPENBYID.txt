â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”§ SOLUTION - Erreur "openById" Google Apps Script
  Configuration CorrigÃ©e pour Newsletter + Contact
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ PROBLÃˆME RENCONTRÃ‰
---------------------
Erreur: "Unexpected error while getting the method or property openById 
on object SpreadsheetApp"

âœ… CAUSE
--------
Le script crÃ©Ã© sÃ©parÃ©ment n'a pas les permissions pour accÃ©der au Sheet.

âœ… SOLUTION
-----------
CrÃ©er le script DEPUIS le Google Sheet (pas sÃ©parÃ©ment).
Cela donne automatiquement les bonnes permissions.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“‹ NOUVELLE MÃ‰THODE (CORRIGÃ‰E)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 1 : Ouvrir votre Google Sheet
------------------------------------
1. Ouvrez votre Sheet :
   https://docs.google.com/spreadsheets/d/1h4zGCPpImYcc2x5wWi6m0QJpZFJnCtEC9jEfy_mIH30/edit

2. Vous Ãªtes maintenant dans le Sheet

Ã‰TAPE 2 : CrÃ©er le Script depuis le Sheet
------------------------------------------
1. Dans le Sheet, cliquez sur : Extensions â†’ Apps Script
2. Un nouvel onglet s'ouvre avec un Ã©diteur de code
3. Supprimez tout le code existant

Ã‰TAPE 3 : Coller le Code SIMPLIFIÃ‰
-----------------------------------
Collez ce nouveau code (VERSION SIMPLIFIÃ‰E) :

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ // SDBQL 2026 - Newsletter + Contact                           â”‚
â”‚                                                                 â”‚
â”‚ function doPost(e) {                                            â”‚
â”‚   try {                                                         â”‚
â”‚     // DÃ©terminer quel formulaire (newsletter ou contact)      â”‚
â”‚     var formType = e.parameter.formType;                       â”‚
â”‚                                                                 â”‚
â”‚     if (formType === 'newsletter') {                           â”‚
â”‚       return handleNewsletter(e);                              â”‚
â”‚     } else if (formType === 'contact') {                       â”‚
â”‚       return handleContact(e);                                 â”‚
â”‚     } else {                                                    â”‚
â”‚       return errorResponse('Type de formulaire inconnu');      â”‚
â”‚     }                                                           â”‚
â”‚   } catch (error) {                                            â”‚
â”‚     return errorResponse(error.toString());                    â”‚
â”‚   }                                                             â”‚
â”‚ }                                                               â”‚
â”‚                                                                 â”‚
â”‚ // GÃ©rer Newsletter                                            â”‚
â”‚ function handleNewsletter(e) {                                 â”‚
â”‚   var email = e.parameter.email;                              â”‚
â”‚   var ss = SpreadsheetApp.getActiveSpreadsheet();             â”‚
â”‚   var sheet = ss.getSheetByName('Newsletter');                â”‚
â”‚                                                                 â”‚
â”‚   // CrÃ©er la feuille si elle n'existe pas                    â”‚
â”‚   if (!sheet) {                                                â”‚
â”‚     sheet = ss.insertSheet('Newsletter');                     â”‚
â”‚     sheet.appendRow(['Date', 'Email']);                       â”‚
â”‚     sheet.getRange('A1:B1').setFontWeight('bold');            â”‚
â”‚   }                                                             â”‚
â”‚                                                                 â”‚
â”‚   // Ajouter les donnÃ©es                                       â”‚
â”‚   var date = new Date();                                       â”‚
â”‚   sheet.appendRow([date, email]);                             â”‚
â”‚                                                                 â”‚
â”‚   return successResponse('Inscription rÃ©ussie !');            â”‚
â”‚ }                                                               â”‚
â”‚                                                                 â”‚
â”‚ // GÃ©rer Contact                                               â”‚
â”‚ function handleContact(e) {                                    â”‚
â”‚   var name = e.parameter.name;                                â”‚
â”‚   var email = e.parameter.email;                              â”‚
â”‚   var subject = e.parameter.subject;                          â”‚
â”‚   var message = e.parameter.message;                          â”‚
â”‚   var ss = SpreadsheetApp.getActiveSpreadsheet();             â”‚
â”‚   var sheet = ss.getSheetByName('Contact');                   â”‚
â”‚                                                                 â”‚
â”‚   // CrÃ©er la feuille si elle n'existe pas                    â”‚
â”‚   if (!sheet) {                                                â”‚
â”‚     sheet = ss.insertSheet('Contact');                        â”‚
â”‚     sheet.appendRow(['Date', 'Nom', 'Email', 'Sujet', 'Message']); â”‚
â”‚     sheet.getRange('A1:E1').setFontWeight('bold');            â”‚
â”‚   }                                                             â”‚
â”‚                                                                 â”‚
â”‚   // Ajouter les donnÃ©es                                       â”‚
â”‚   var date = new Date();                                       â”‚
â”‚   sheet.appendRow([date, name, email, subject, message]);    â”‚
â”‚                                                                 â”‚
â”‚   return successResponse('Message envoyÃ© avec succÃ¨s !');     â”‚
â”‚ }                                                               â”‚
â”‚                                                                 â”‚
â”‚ // RÃ©ponse succÃ¨s                                              â”‚
â”‚ function successResponse(message) {                            â”‚
â”‚   return ContentService.createTextOutput(JSON.stringify({     â”‚
â”‚     'status': 'success',                                       â”‚
â”‚     'message': message                                         â”‚
â”‚   })).setMimeType(ContentService.MimeType.JSON);              â”‚
â”‚ }                                                               â”‚
â”‚                                                                 â”‚
â”‚ // RÃ©ponse erreur                                              â”‚
â”‚ function errorResponse(message) {                              â”‚
â”‚   return ContentService.createTextOutput(JSON.stringify({     â”‚
â”‚     'status': 'error',                                         â”‚
â”‚     'message': 'Erreur: ' + message                           â”‚
â”‚   })).setMimeType(ContentService.MimeType.JSON);              â”‚
â”‚ }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Ã‰TAPE 4 : Enregistrer le Projet
--------------------------------
1. Cliquez sur l'icÃ´ne disquette (ğŸ’¾) ou Ctrl+S
2. Nommez le projet : "SDBQL Formulaires"

Ã‰TAPE 5 : DÃ©ployer le Script
-----------------------------
1. Cliquez sur "DÃ©ployer" (en haut Ã  droite) â†’ "Nouveau dÃ©ploiement"
2. Cliquez sur l'icÃ´ne âš™ï¸ â†’ "Application Web"
3. Configuration :
   - Description : "SDBQL Newsletter + Contact"
   - ExÃ©cuter en tant que : "Moi"
   - Qui a accÃ¨s : "Tout le monde"
4. Cliquez sur "DÃ©ployer"
5. Cliquez sur "Autoriser l'accÃ¨s"
6. Choisissez votre compte Google
7. Cliquez sur "AvancÃ©" â†’ "AccÃ©der Ã  SDBQL Formulaires (non sÃ©curisÃ©)"
8. Cliquez sur "Autoriser"

Ã‰TAPE 6 : Copier l'URL
-----------------------
Vous obtenez UNE SEULE URL (pour les 2 formulaires) :

   https://script.google.com/macros/s/XXXXXXXXXXXXXXX/exec
                                        â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘â†‘
                                        COPIEZ CETTE URL !

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“ MODIFIER LE FICHIER forms-handler.js
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ouvrez forms-handler.js et remplacez les lignes 11-14 par :

// URL UNIQUE pour les 2 formulaires
const SCRIPT_URL = 'COLLEZ_VOTRE_URL_ICI';

const NEWSLETTER_SCRIPT_URL = SCRIPT_URL;
const CONTACT_SCRIPT_URL = SCRIPT_URL;

Exemple :

const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbXXXX/exec';
const NEWSLETTER_SCRIPT_URL = SCRIPT_URL;
const CONTACT_SCRIPT_URL = SCRIPT_URL;

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”§ MODIFIER forms-handler.js (Ajout formType)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Dans forms-handler.js, trouvez ces lignes et ajoutez formType :

POUR NEWSLETTER (ligne ~48) :
------------------------------
AVANT :
const formData = new FormData();
formData.append('email', email);

APRÃˆS :
const formData = new FormData();
formData.append('formType', 'newsletter');  // â† AJOUTER
formData.append('email', email);


POUR CONTACT (ligne ~108) :
----------------------------
AVANT :
const formData = new FormData();
formData.append('name', name);
formData.append('email', email);
formData.append('subject', subject);
formData.append('message', message);

APRÃˆS :
const formData = new FormData();
formData.append('formType', 'contact');  // â† AJOUTER
formData.append('name', name);
formData.append('email', email);
formData.append('subject', subject);
formData.append('message', message);

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âœ… TESTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Ouvrez index.html
2. Testez Newsletter :
   - Entrez un email
   - Cliquez sur â†’
   - Attendez 2-3 secondes
   - Vous devriez voir : "âœ… Inscription rÃ©ussie !"

3. VÃ©rifiez Google Sheets :
   - Nouvelle feuille "Newsletter" crÃ©Ã©e
   - Votre email enregistrÃ©

4. Testez Contact :
   - Remplissez le formulaire
   - Cliquez sur "Envoyer"
   - Vous devriez voir : "Message envoyÃ© avec succÃ¨s !"

5. VÃ©rifiez Google Sheets :
   - Nouvelle feuille "Contact" crÃ©Ã©e
   - Votre message enregistrÃ©

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ¯ AVANTAGES DE CETTE MÃ‰THODE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… UN SEUL script au lieu de 2
âœ… Permissions automatiques (pas de problÃ¨me openById)
âœ… Plus simple Ã  gÃ©rer
âœ… Une seule URL Ã  copier
âœ… Fonctionne immÃ©diatement

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ› SI Ã‡A NE FONCTIONNE TOUJOURS PAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Ouvrez la console du navigateur (F12)
2. Regardez les erreurs JavaScript
3. VÃ©rifiez que l'URL est correcte dans forms-handler.js
4. VÃ©rifiez que formType est bien ajoutÃ©

Si vous voyez "CORS error" :
â†’ C'est normal pendant le dÃ©ploiement
â†’ Attendez 2-3 minutes et rÃ©essayez

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Avec cette mÃ©thode, Ã§a devrait fonctionner parfaitement ! ğŸ‰

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
