â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”§ SCRIPT GOOGLE APPS SCRIPT CORRIGÃ‰
  Solution pour le problÃ¨me : Seule la date apparaÃ®t
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ PROBLÃˆME
-----------
Seule la date s'enregistre dans Google Sheets.
Les autres donnÃ©es (email, nom, message) n'apparaissent pas.

âœ… CAUSE
--------
FormData avec POST ne fonctionne pas bien avec Google Apps Script.

âœ… SOLUTION
-----------
Utiliser URLSearchParams avec GET (mÃ©thode URL).

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“ NOUVEAU CODE GOOGLE APPS SCRIPT (CORRIGÃ‰)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INSTRUCTIONS :
1. Retournez dans votre Google Apps Script
2. Supprimez TOUT le code
3. Collez le code ci-dessous
4. Enregistrez (Ctrl+S)
5. PAS BESOIN de redÃ©ployer ! L'ancien dÃ©ploiement fonctionne.

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ // SDBQL 2026 - Newsletter + Contact (VERSION CORRIGÃ‰E)        â”‚
â”‚                                                                 â”‚
â”‚ function doGet(e) {                                             â”‚
â”‚   try {                                                         â”‚
â”‚     var formType = e.parameter.formType;                       â”‚
â”‚                                                                 â”‚
â”‚     if (formType === 'newsletter') {                           â”‚
â”‚       return handleNewsletter(e);                              â”‚
â”‚     } else if (formType === 'contact') {                       â”‚
â”‚       return handleContact(e);                                 â”‚
â”‚     } else {                                                    â”‚
â”‚       return errorResponse('Type de formulaire inconnu');      â”‚
â”‚     }                                                           â”‚
â”‚   } catch (error) {                                            â”‚
â”‚     return errorResponse(error.toString());                    â”‚
â”‚   }                                                             â”‚
â”‚ }                                                               â”‚
â”‚                                                                 â”‚
â”‚ function handleNewsletter(e) {                                 â”‚
â”‚   try {                                                         â”‚
â”‚     var email = e.parameter.email;                            â”‚
â”‚                                                                 â”‚
â”‚     // VÃ©rifier que l'email existe                            â”‚
â”‚     if (!email || email === '') {                             â”‚
â”‚       return errorResponse('Email manquant');                 â”‚
â”‚     }                                                           â”‚
â”‚                                                                 â”‚
â”‚     var ss = SpreadsheetApp.getActiveSpreadsheet();           â”‚
â”‚     var sheet = ss.getSheetByName('Newsletter');              â”‚
â”‚                                                                 â”‚
â”‚     // CrÃ©er la feuille si elle n'existe pas                  â”‚
â”‚     if (!sheet) {                                              â”‚
â”‚       sheet = ss.insertSheet('Newsletter');                   â”‚
â”‚       sheet.appendRow(['Date', 'Email']);                     â”‚
â”‚       sheet.getRange('A1:B1').setFontWeight('bold');          â”‚
â”‚       sheet.setFrozenRows(1);                                 â”‚
â”‚     }                                                           â”‚
â”‚                                                                 â”‚
â”‚     // Ajouter les donnÃ©es                                     â”‚
â”‚     var date = Utilities.formatDate(new Date(),               â”‚
â”‚                  Session.getScriptTimeZone(),                  â”‚
â”‚                  'dd/MM/yyyy HH:mm:ss');                       â”‚
â”‚     sheet.appendRow([date, email]);                           â”‚
â”‚                                                                 â”‚
â”‚     return successResponse('Inscription rÃ©ussie !');          â”‚
â”‚   } catch (error) {                                            â”‚
â”‚     return errorResponse('Erreur Newsletter: ' + error);      â”‚
â”‚   }                                                             â”‚
â”‚ }                                                               â”‚
â”‚                                                                 â”‚
â”‚ function handleContact(e) {                                    â”‚
â”‚   try {                                                         â”‚
â”‚     var name = e.parameter.name;                              â”‚
â”‚     var email = e.parameter.email;                            â”‚
â”‚     var subject = e.parameter.subject;                        â”‚
â”‚     var message = e.parameter.message;                        â”‚
â”‚                                                                 â”‚
â”‚     // VÃ©rifier que les donnÃ©es existent                      â”‚
â”‚     if (!name || !email || !subject || !message) {           â”‚
â”‚       return errorResponse('DonnÃ©es manquantes');             â”‚
â”‚     }                                                           â”‚
â”‚                                                                 â”‚
â”‚     var ss = SpreadsheetApp.getActiveSpreadsheet();           â”‚
â”‚     var sheet = ss.getSheetByName('Contact');                 â”‚
â”‚                                                                 â”‚
â”‚     // CrÃ©er la feuille si elle n'existe pas                  â”‚
â”‚     if (!sheet) {                                              â”‚
â”‚       sheet = ss.insertSheet('Contact');                      â”‚
â”‚       sheet.appendRow(['Date', 'Nom', 'Email',                â”‚
â”‚                        'Sujet', 'Message']);                   â”‚
â”‚       sheet.getRange('A1:E1').setFontWeight('bold');          â”‚
â”‚       sheet.setFrozenRows(1);                                 â”‚
â”‚       // Ajuster les largeurs des colonnes                    â”‚
â”‚       sheet.setColumnWidth(1, 150); // Date                   â”‚
â”‚       sheet.setColumnWidth(2, 150); // Nom                    â”‚
â”‚       sheet.setColumnWidth(3, 200); // Email                  â”‚
â”‚       sheet.setColumnWidth(4, 150); // Sujet                  â”‚
â”‚       sheet.setColumnWidth(5, 400); // Message                â”‚
â”‚     }                                                           â”‚
â”‚                                                                 â”‚
â”‚     // Ajouter les donnÃ©es                                     â”‚
â”‚     var date = Utilities.formatDate(new Date(),               â”‚
â”‚                  Session.getScriptTimeZone(),                  â”‚
â”‚                  'dd/MM/yyyy HH:mm:ss');                       â”‚
â”‚     sheet.appendRow([date, name, email, subject, message]);  â”‚
â”‚                                                                 â”‚
â”‚     return successResponse('Message envoyÃ© avec succÃ¨s !');   â”‚
â”‚   } catch (error) {                                            â”‚
â”‚     return errorResponse('Erreur Contact: ' + error);         â”‚
â”‚   }                                                             â”‚
â”‚ }                                                               â”‚
â”‚                                                                 â”‚
â”‚ function successResponse(message) {                            â”‚
â”‚   return ContentService.createTextOutput(JSON.stringify({     â”‚
â”‚     'status': 'success',                                       â”‚
â”‚     'message': message                                         â”‚
â”‚   })).setMimeType(ContentService.MimeType.JSON);              â”‚
â”‚ }                                                               â”‚
â”‚                                                                 â”‚
â”‚ function errorResponse(message) {                              â”‚
â”‚   return ContentService.createTextOutput(JSON.stringify({     â”‚
â”‚     'status': 'error',                                         â”‚
â”‚     'message': 'Erreur: ' + message                           â”‚
â”‚   })).setMimeType(ContentService.MimeType.JSON);              â”‚
â”‚ }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âœ… CHANGEMENTS PRINCIPAUX
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. doPost(e) â†’ doGet(e)
   â””â”€ Car on utilise maintenant GET au lieu de POST

2. VÃ©rification des donnÃ©es
   â””â”€ VÃ©rifie que email, name, etc. ne sont pas vides

3. Format de date amÃ©liorÃ©
   â””â”€ Date lisible : "30/01/2026 14:30:15"

4. Largeurs de colonnes automatiques
   â””â”€ Pour que le message soit bien visible

5. En-tÃªtes en gras + ligne figÃ©e
   â””â”€ Pour un meilleur affichage

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸš€ Ã‰TAPES Ã€ SUIVRE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰TAPE 1 : Modifier le Script Google
------------------------------------
1. Retournez dans Google Apps Script
2. Supprimez TOUT le code actuel
3. Collez le nouveau code ci-dessus
4. Ctrl+S pour sauvegarder

IMPORTANT : PAS BESOIN DE REDÃ‰PLOYER !
Le dÃ©ploiement existant continuera de fonctionner.


Ã‰TAPE 2 : Tester
----------------
1. Ouvrez index.html
2. Testez Newsletter :
   - Entrez : test@example.com
   - Cliquez sur â†’
   - VÃ©rifiez Google Sheets â†’ Vous devriez voir :
     * Date : 30/01/2026 14:30:15
     * Email : test@example.com

3. Testez Contact :
   - Nom : Jean Dupont
   - Email : jean@example.com
   - Sujet : Test
   - Message : Ceci est un test
   - VÃ©rifiez Google Sheets â†’ Vous devriez voir TOUTES les donnÃ©es !


Ã‰TAPE 3 : Nettoyer (Optionnel)
-------------------------------
Si vous avez des lignes avec seulement la date :
1. Ouvrez Google Sheets
2. SÃ©lectionnez ces lignes
3. Clic droit â†’ Supprimer les lignes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“Š RÃ‰SULTAT ATTENDU DANS GOOGLE SHEETS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FEUILLE "Newsletter" :
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Date                 â”‚ Email               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 30/01/2026 14:30:15 â”‚ test@example.com    â”‚
â”‚ 30/01/2026 14:35:20 â”‚ user@gmail.com      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FEUILLE "Contact" :
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Date                 â”‚ Nom        â”‚ Email        â”‚ Sujet    â”‚ Message        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 30/01/2026 14:40:10 â”‚ Jean D.    â”‚ jean@mail.câ€¦ â”‚ Question â”‚ Bonjour...     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ¯ POURQUOI CETTE SOLUTION FONCTIONNE ?
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ AVANT (FormData + POST) :
   - FormData mal parsÃ© par Google Apps Script
   - Seul e.parameter existe, mais vide
   - RÃ©sultat : Seule la date s'enregistre

âœ… MAINTENANT (URLSearchParams + GET) :
   - DonnÃ©es dans l'URL : ?formType=newsletter&email=test@example.com
   - Google Apps Script parse facilement e.parameter.email
   - RÃ©sultat : TOUTES les donnÃ©es s'enregistrent !

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âœ… CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ ] Ouvrir Google Apps Script
[ ] Supprimer tout le code
[ ] Coller le nouveau code (doGet)
[ ] Enregistrer (Ctrl+S)
[ ] Tester Newsletter â†’ Email visible âœ“
[ ] Tester Contact â†’ Toutes les donnÃ©es visibles âœ“
[ ] Nettoyer les anciennes lignes (optionnel)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‰ Avec ce nouveau code, TOUTES vos donnÃ©es seront enregistrÃ©es !

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
